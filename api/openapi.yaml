openapi: 3.0.3
info:
  title: Paid Leave API
  description: An API for managing leave within Massachusetts Paid Family and Medical Leave.
  version: "2022-01-06"

servers:
  - url: /v1
    description: Development server

security:
  - jwt: [] # JWT authentication option

paths:
  /status:
    get:
      security:
        - {} # no authentication option
      tags:
        - Test Endpoints
      summary: Get the API status
      operationId: massgov.pfml.api.status.status_get
      responses:
        "200":
          description: A successful request returns a 200 status code and a user object.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/SuccessfulResponse"
        "503":
          $ref: "#/components/responses/ServiceUnavailableError"

  /flags:
    get:
      security:
        - {} # no authentication option
      tags:
        - Feature Flags
      summary: Get feature flags
      operationId: massgov.pfml.api.flags.flags_get
      responses:
        "200":
          description: A successful request returns a 200 status code and list of flags.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/FlagsResponse"
        "503":
          $ref: "#/components/responses/ServiceUnavailableError"

  /users:
    post:
      security:
        - {} # no authentication option
      tags:
        - Users
      summary: Create a User account
      operationId: massgov.pfml.api.users.users_post
      responses:
        "201":
          description: User account was created.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/UserResponse"
        "400":
          $ref: "#/components/responses/BadRequest"
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/UserCreateRequest"

  /roles:
    delete:
      tags:
        - Roles
        - Users
      summary: Remove a role from a user
      operationId: massgov.pfml.api.roles.roles_users_delete
      responses:
        "204":
          description: Role deleted without issue
        "400":
          $ref: "#/components/responses/BadRequest"
        "404":
          $ref: "#/components/responses/NotFound"
      requestBody:
        $ref: "#/components/requestBodies/RoleUserDeleteRequest"

  /users/{user_id}/convert_employer:
    post:
      tags:
        - Users
      summary: Convert a User account to an employer role
      operationId: massgov.pfml.api.users.users_convert_employer
      parameters:
        - name: user_id
          in: path
          schema:
            type: string
          description: ID of User to update
          required: true
      responses:
        "201":
          description: User converted without errors
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/UserResponse"
        "400":
          $ref: "#/components/responses/BadRequest"
        "404":
          $ref: "#/components/responses/NotFound"
      requestBody:
        $ref: '#/components/requestBodies/EmployerAddFeinRequestBody'

  /users/{user_id}:
    get:
      tags:
        - Users
      summary: Retrieve a User account
      operationId: massgov.pfml.api.users.users_get
      parameters:
        - name: user_id
          in: path
          schema:
            type: string
            format: uuid
          description: ID of User to update
          required: true
      responses:
        "200":
          description: A successful request returns a 200 status code and a user object.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/UserResponse"
        "404":
          $ref: "#/components/responses/NotFound"
    patch:
      tags:
        - Users
      summary: Update a User account
      operationId: massgov.pfml.api.users.users_patch
      parameters:
        - name: user_id
          in: path
          schema:
            type: string
          description: ID of User to update
          required: true
      responses:
        "200":
          description: A successful request returns a 200 status code and a user object.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/UserResponse"
        "404":
          $ref: "#/components/responses/NotFound"
      requestBody:
        $ref: "#/components/requestBodies/UserUpdateRequest"

  /users/current:
    get:
      tags:
        - Users
      summary: >
        Retrieve the User account corresponding to the currently authenticated
        user
      operationId: massgov.pfml.api.users.users_current_get
      responses:
        "200":
          description: A successful request returns a 200 status code and a user object.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/UserResponse"

  /employees/{employee_id}:
    get:
      security:
        - jwt: []
        - oauth2: []
      tags:
        - Employees
      summary: Retrieve an Employee record
      operationId: massgov.pfml.api.employees.employees_get
      parameters:
        - name: employee_id
          in: path
          schema:
            type: string
          description: ID of Employee to retrieve
          required: true
      responses:
        "200":
          description: A successful request returns a 200 status code and an employee object.
          content:
            application/json:
              schema:
                allOf:
                  - $ref: "#/components/schemas/SuccessfulResponse"
                  - properties:
                      data:
                        $ref: "#/components/schemas/EmployeeResponse"
        "404":
          description: An unsuccessful request returns a 404 status code for employees that are not found.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/EmployeeErrorResponse"
    patch:
      tags:
        - Employees
      summary: Update an Employee record, for mutable properties
      operationId: massgov.pfml.api.employees.employees_patch
      parameters:
        - name: employee_id
          in: path
          schema:
            type: string
          description: ID of Employee to update
          required: true
      responses:
        "200":
          description: A successful response returns a 200 status code and an employee object.
          content:
            application/json:
              schema:
                allOf:
                  - $ref: "#/components/schemas/SuccessfulResponse"
                  - properties:
                      data:
                        $ref: "#/components/schemas/EmployeeResponse"
        "404":
          $ref: "#/components/responses/NotFound"
      requestBody:
        $ref: "#/components/requestBodies/EmployeeUpdateRequest"

  /employees/search:
    post:
      security:
        - jwt: []
        - oauth2: []
      tags:
        - Employees
      summary: Lookup an Employee by SSN/ITIN and name
      operationId: massgov.pfml.api.employees.employees_search
      responses:
        "200":
          description: A successful response returns a 200 status code and an employee object.
          content:
            application/json:
              schema:
                allOf:
                  - $ref: "#/components/schemas/SuccessfulResponse"
                  - properties:
                      data:
                        $ref: "#/components/schemas/EmployeeResponse"
        "404":
          $ref: "#/components/responses/NotFound"
      requestBody:
        $ref: "#/components/requestBodies/EmployeeSearchRequest"

  /employers/add:
    post:
      tags:
        - Employers
      summary: Add an FEIN to the logged in Leave Administrator
      operationId: massgov.pfml.api.employers.employer_add_fein
      requestBody:
        $ref: '#/components/requestBodies/EmployerAddFeinRequestBody'
      responses:
        "201":
          description: FEIN added without errors
          content:
            application/json:
              schema:
                allOf:
                  - $ref: "#/components/schemas/SuccessfulResponse"
                  - properties:
                      data:
                        $ref: "#/components/schemas/EmployerResponse"
        "400":
          $ref: "#/components/responses/BadRequest"
        "402":
          description: No verification data for FEIN
          content:
            application/json:
              schema:
                allOf:
                  - $ref: "#/components/schemas/ErrorResponse"
        "409":
          description: Duplicate employer for user
          content:
            application/json:
              schema:
                allOf:
                  - $ref: "#/components/schemas/ErrorResponse"
        "503":
          description: Error while adding FEIN
          content:
            application/json:
              schema:
                allOf:
                  - $ref: "#/components/schemas/ErrorResponse"

  /employers/withholding/{employer_id}:
    get:
      summary: Retrieves the last withholding date for the FEIN specified
      operationId: massgov.pfml.api.employers.employer_get_most_recent_withholding_dates
      tags:
        - Employers
      parameters:
        - name: employer_id
          in: path
          schema:
            type: string
            format: uuid
            example: "009fa369-291b-403f-a85a-15e938c26f2f"
          description: "ID of the employer"
          required: true
      responses:
        "200":
          description: A successful request returns a 200 status code.
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessfulResponse'
                  - properties:
                      data:
                        $ref: "#/components/schemas/WithholdingResponse"
        "400":
          description: An unsuccessful request returns a 400 status code if one or more errors occurred.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"

  /claims/{fineos_absence_id}:
    get:
      summary: Retrieve a claim for a specified absence ID
      operationId: massgov.pfml.api.claims.get_claim
      tags:
        - Claims
      parameters:
        - name: fineos_absence_id
          in: path
          schema:
            type: string
            example: "NTN-00-ABS-00"
          description: "FINEOS absence ID of the claim data to be retrieved"
          required: true
      responses:
        "200":
          description: The claim information.
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessfulResponse'
                  - properties:
                      data:
                        $ref: "#/components/schemas/DetailedClaimResponse"
        "400":
          description: An unsuccessful request returns a 400 status code if one or more errors occurred.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"

  /claims:
    get:
      security:
        - jwt: []
        - oauth2: []
      summary: Retrieve claims
      operationId: massgov.pfml.api.claims.get_claims
      tags:
        - Claims
      parameters:
        - $ref: "#/components/parameters/pageSize"
        - $ref: "#/components/parameters/pageOffset"
        - $ref: "#/components/parameters/orderBy"
        - $ref: "#/components/parameters/orderDirection"
        - name: employer_id
          in: query
          schema:
            type: string
            format: uuid
          description: ID of Employer to query claims for
          required: false
        - name: employee_id
          in: query
          schema:
            type: array
            items:
                type: string
                format: uuid
          description: ID(s) of Employee to query claims for
          required: false
          explode: false
        - name: "claim_status"
          in: query
          schema:
            type: string
            pattern: '[a-zA-Z0-9 ,]+'
          description: >
            claim status used to filter the request,
            single claim status or a comma seperated list of claim status (i.e claim_status="Approved,Closed"),
            the valid status are "Approved", "Closed", "Completed", "Declined", "Open requirement" and "Pending - no action".
          required: false
        - name: "search"
          in: query
          schema:
            type: string
          description: >
            A search string used to filter the request that,
            when provided, is used in a fuzzy search against the claims'
            Absence Case IDs, in addition to the employees' first, middle, and last names.
            When the string is empty, it is ignored.
          required: false
        - name: "allow_hrd"
          in: query
          schema:
            type: boolean
          description: A temporary boolean value used to allow smoke testers to see HRD dashboard
          required: false
      responses:
        "200":
          description: The claim information.
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessfulResponse'
                  - properties:
                      data:
                        $ref: "#/components/schemas/ClaimsResponse"
        "400":
          description: An unsuccessful request returns a 400 status code if one or more errors occurred.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"

  /payments:
    get:
      summary: Retrieve payments with status for a specified absence ID
      operationId: massgov.pfml.api.payments.get_payments
      tags:
        - Claims
      parameters:
        - name: absence_case_id
          in: query
          schema:
            type: string
            example: "NTN-00-ABS-00"
          description: "FINEOS absence ID of the claim associated with payment data to be retrieved"
          required: true
      responses:
        "200":
          description: The payments for this absence case.
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessfulResponse'
                  - properties:
                      data:
                        $ref: '#/components/schemas/PaymentsResponse'

  /employers/claims/{fineos_absence_id}/documents/{fineos_document_id}:
    get:
      summary: Retrieve a FINEOS documents for a specified absence ID and document ID
      operationId: massgov.pfml.api.claims.employer_document_download
      tags:
        - Claims
      parameters:
        - name: fineos_absence_id
          in: path
          schema:
            type: string
            example: "NTN-00-ABS-00"
          description: "FINEOS absence ID of the claim data to be retrieved"
          required: true
        - name: fineos_document_id
          in: path
          schema:
            type: string
            example: "1111"
          description: "FINEOS document ID pertaining to the claim that will be retrieved"
          required: true
      responses:
        "200":
          description: The document stream.
          content:
            application/octet-stream:
              schema:
                type: string
                format: binary
        "400":
          description: An unsuccessful request returns a 400 status code if one or more errors occurred.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"

  /employers/claims/{fineos_absence_id}/documents:
    get:
      summary: Retrieve a list of FINEOS documents for a specified absence ID
      operationId: massgov.pfml.api.claims.employer_get_claim_documents
      tags:
        - Claims
      parameters:
        - name: fineos_absence_id
          in: path
          schema:
            type: string
            example: "NTN-00-ABS-00"
          description: "FINEOS absence ID of the claim data to be retrieved"
          required: true
      responses:
        "200":
          description: A successful request returns a 200 status code.
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessfulResponse'
                  - properties:
                      data:
                        $ref: "#/components/schemas/ClaimDocumentResponse"
        "400":
          description: An unsuccessful request returns a 400 status code if one or more errors occurred.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"

  /employers/claims/{fineos_absence_id}/review:
    get:
      summary: Retrieve FINEOS claim review data for a specified absence ID
      operationId: massgov.pfml.api.claims.employer_get_claim_review
      tags:
        - Claims
      parameters:
        - name: fineos_absence_id
          in: path
          schema:
            type: string
            example: "NTN-00-ABS-00"
          description: "FINEOS absence ID of the claim data to be retrieved"
          required: true
      responses:
        "200":
          description: A successful request returns a 200 status code.
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessfulResponse'
                  - properties:
                      data:
                        $ref: "#/components/schemas/ClaimReviewResponse"
        "400":
          description: An unsuccessful request returns a 400 status code if one or more errors occurred.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "404":
          $ref: "#/components/responses/NotFound"
    patch:
      tags:
        - Claims
      summary: Save review claim from leave admin
      operationId: massgov.pfml.api.claims.employer_update_claim_review
      parameters:
        - name: fineos_absence_id
          in: path
          schema:
            type: string
            example: "NTN-00-ABS-00"
          description: ID of absence to update
          required: true
      responses:
        "200":
          description: A successful request returns a 200 status code and a claim object.
          content:
            application/json:
              schema:
                allOf:
                  - $ref: "#/components/schemas/SuccessfulResponse"
                  - properties:
                      data:
                        $ref: "#/components/schemas/UpdateClaimReviewResponse"
        "404":
          $ref: "#/components/responses/NotFound"
      requestBody:
        $ref: "#/components/requestBodies/EmployerClaimRequestBody"

  /applications:
    post:
      tags:
        - Applications
      summary: Create an Application
      operationId: massgov.pfml.api.applications.applications_start
      responses:
        "200":
          $ref: "#/components/responses/ApplicationCreatedResponse"
        "400":
          $ref: "#/components/responses/BadRequest"

    get:
      tags:
        - Applications
      summary: Retrieve all Applications for the specified user
      operationId: massgov.pfml.api.applications.applications_get
      responses:
        "200":
          $ref: "#/components/responses/ApplicationSearchResponse"

  /applications/{application_id}:
    get:
      tags:
        - Applications
      summary: Retrieve an Application identified by the application id
      operationId: massgov.pfml.api.applications.application_get
      parameters:
        - name: application_id
          in: path
          schema:
            type: string
            format: uuid
          description: ID of Application to retrieve
          required: true
      responses:
        "200":
          $ref: "#/components/responses/ApplicationResponse"
        "404":
          $ref: "#/components/responses/NotFound"

    patch:
      tags:
        - Applications
      summary: Update an Application
      description: >
        Supports partial update of an Application record.

        Note that array property updates are not partial, after processing the
        PATCH, the Application state will contain only the values of the array
        in the request.

        The behavior generally follows RFC 7396.

        It is expected clients will call this endpoint multiple times and with
        incomplete data as individual pieces of information is collected from
        the user. The API will review the data provided and return any pertinent
        warnings or errors.
      operationId: massgov.pfml.api.applications.applications_update
      parameters:
        - name: application_id
          in: path
          schema:
            type: string
            format: uuid
          description: ID of Application to update
          required: true
      responses:
        "200":
          description: Application updated without errors.
          content:
            application/json:
              schema:
                allOf:
                  - $ref: "#/components/schemas/SuccessfulResponse"
                  - properties:
                      data:
                        $ref: "#/components/schemas/ApplicationResponse"
        "400":
          description: An unsuccessful request returns a 400 status code if one or more errors occured, described in the error response.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
      requestBody:
        $ref: "#/components/requestBodies/ApplicationRequestBody"

  /applications/import:
    post:
      tags:
        - Applications
      summary: >
        Creates a new application in the PFML database from a FINEOS application that was created through the
        contact center.
      operationId: massgov.pfml.api.applications.applications_import
      responses:
        "201":
          $ref: "#/components/responses/ApplicationImportedResponse"
        "400":
          $ref: "#/components/responses/BadRequest"
        "404":
          description: Application with requested absence_case_id was not found.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "503":
          description: Application could not be completed in Claims Processing System.
          content:
            application/json:
              schema:
                allOf:
                  - $ref: "#/components/schemas/ErrorResponse"
                  - properties:
                      data:
                        $ref: "#/components/schemas/ApplicationResponse"
      requestBody:
        $ref: '#/components/requestBodies/ApplicationImportRequestBody'


  /applications/{application_id}/submit_application:
    post:
      tags:
        - Applications
      summary: >
        Submit the first part of the application to the Claims Processing System.
      operationId: massgov.pfml.api.applications.applications_submit
      parameters:
        - name: application_id
          in: path
          schema:
            type: string
            format: uuid
          description: ID of Application to submit
          required: true
      responses:
        "201":
          description: Application submitted without errors.
          content:
            application/json:
              schema:
                allOf:
                  - $ref: "#/components/schemas/SuccessfulResponse"
                  - properties:
                      data:
                        $ref: "#/components/schemas/ApplicationResponse"
        "400":
          $ref: "#/components/responses/BadRequest"
        "503":
          description: Application could not be submitted to Claims Processing System.
          content:
            application/json:
              schema:
                allOf:
                  - $ref: "#/components/schemas/ErrorResponse"
                  - properties:
                      data:
                        $ref: "#/components/schemas/ApplicationResponse"

  /applications/{application_id}/complete_application:
    post:
      tags:
        - Applications
      summary: >
        Complete intake of an application in the Claims Processing System.
      operationId: massgov.pfml.api.applications.applications_complete
      parameters:
        - name: application_id
          in: path
          schema:
            type: string
            format: uuid
          description: ID of Application to submit
          required: true
      responses:
        "201":
          description: Application completed without errors.
          content:
            application/json:
              schema:
                allOf:
                  - $ref: "#/components/schemas/SuccessfulResponse"
                  - properties:
                      data:
                        $ref: "#/components/schemas/ApplicationResponse"
        "400":
          $ref: "#/components/responses/BadRequest"
        "503":
          description: Application could not be completed in Claims Processing System.
          content:
            application/json:
              schema:
                allOf:
                  - $ref: "#/components/schemas/ErrorResponse"
                  - properties:
                      data:
                        $ref: "#/components/schemas/ApplicationResponse"

  /applications/{application_id}/documents/{document_id}:
    get:
      summary: Download an application (case) document by id.
      operationId: massgov.pfml.api.applications.document_download
      tags:
        - Applications
      parameters:
        - name: application_id
          in: path
          schema:
            type: string
            format: uuid
            example: 5f91c12b-4d49-4eb0-b5d9-7fa0ce13eb32
          description: ID of Application the document is associated with
          required: true
        - name: document_id
          in: path
          schema:
            type: string
            example: "4074"
          description: The fineos document id
          required: true
      responses:
        "200":
          description: The document stream.
          content:
            application/octet-stream:
              schema:
                type: string
                format: binary
        "400":
          description: An unsuccessful request returns a 400 status code if one or more errors occurred.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"

  /applications/{application_id}/documents:
    get:
      summary: Get list of documents for a case
      operationId: massgov.pfml.api.applications.documents_get
      tags:
        - Applications
        - Documents
      parameters:
        - name: application_id
          in: path
          schema:
            type: string
            format: uuid
            example: 5f91c12b-4d49-4eb0-b5d9-7fa0ce13eb32
          description: ID of Application to update
          required: true
      responses:
        "200":
          description: A successful request returns a 200 status code.
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessfulResponse'
                  - properties:
                      data:
                        type: array
                        items:
                          $ref: "#/components/schemas/DocumentResponse"
        "400":
          description: An unsuccessful request returns a 400 status code if one or more errors occurred.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
    post:
      summary: Upload Document
      operationId: massgov.pfml.api.applications.document_upload
      tags:
        - Applications
        - Documents
      parameters:
        - name: application_id
          in: path
          schema:
            type: string
            format: uuid
            example: 5f91c12b-4d49-4eb0-b5d9-7fa0ce13eb32
          description: ID of Application to update
          required: true
      requestBody:
        content:
          multipart/form-data:
            schema:
              $ref: '#/components/schemas/DocumentUploadRequest'
            encoding:
              file:
                contentType: application/pdf, image/jpeg, image/png, image/tiff, image/heic
      responses:
        "200":
          description: A successful request returns a 200 status code.
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessfulResponse'
                  - properties:
                      data:
                        $ref: "#/components/schemas/DocumentResponse"
        "400":
          description: An unsuccessful request returns a 400 status code if one or more errors occurred.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"

  /applications/{application_id}/submit_payment_preference:
    post:
      summary: Submit Payment Preference
      operationId: massgov.pfml.api.applications.payment_preference_submit
      tags:
        - Applications
        - PaymentPreference
      parameters:
        - name: application_id
          in: path
          schema:
            type: string
            format: uuid
            example: 5f91c12b-4d49-4eb0-b5d9-7fa0ce13eb32
          description: ID of Application to update
          required: true
      requestBody:
        $ref: '#/components/requestBodies/PaymentPreferenceRequestBody'
      responses:
        "201":
          description: Successful payment submission returns a 201 status code.
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessfulResponse'
                  - properties:
                      data:
                        $ref: '#/components/schemas/ApplicationResponse'
        "400":
          description: Invalid payment preference when attempting to submit to FINEOS.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "404":
          description: Application with requested application_id was not found.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "503":
          description: Payment preference failed to save.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"

  /applications/{application_id}/submit_tax_withholding_preference:
    post:
      summary: Submit Tax Withholding Preference
      operationId: massgov.pfml.api.applications.submit_tax_withholding_preference
      tags:
        - Applications
        - TaxPreference
      parameters:
        - name: application_id
          in: path
          schema:
            type: string
            format: uuid
            example: 5f91c12b-4d49-4eb0-b5d9-7fa0ce13eb32
          description: ID of the application to update
          required: true
      requestBody:
        $ref: "#/components/requestBodies/TaxWithholdingPreferenceRequestBody"
      responses:
        "201":
          description: Successful submission of tax withholding preference returns a 201
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessfulResponse'
                  - properties:
                      data:
                        $ref: '#/components/schemas/ApplicationResponse'
        "400":
          description: Error when attempting to submit tax withholding preference to FINEOS
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "404":
          description: Application with requested application_id was not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
        "503":
          description: Tax withholding preference failed to save.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"

  /financial-eligibility:
    post:
      security:
        - oauth2: []
      tags:
        - Financial Eligibility
      summary: Retrieve financial eligibility by SSN/ITIN, FEIN, leave start date, application submitted date and employment status.
      operationId: massgov.pfml.api.eligibility.handler.eligibility_post
      responses:
        "200":
          description: a successful response returns a 200 status code a financial_eligibility object.
          content:
            application/json:
              schema:
                allOf:
                  - $ref: "#/components/schemas/SuccessfulResponse"
                  - properties:
                      data:
                        $ref: "#/components/schemas/EligibilityResponse"
                example:
                  meta:
                    method: "POST"
                    resource: "/financial-eligibility"
                  status_code: 200
                  message: "success"
                  data:
                    financially_eligible: true
                    description: "Financially eligible"
                    total_wages: 55000
                    state_average_weekly_wage: 1431
                    unemployment_minimum: 5100
                    employer_average_weekly_wage: 1500
        "400":
          $ref: "#/components/responses/BadRequest"
      requestBody:
        $ref: "#/components/requestBodies/EligibilityRequest"

  /rmv-check:
    post:
      security:
        - oauth2: []
      tags:
        - ID Proofing
      summary: Perform lookup and data matching for information on RMV-issued IDs
      operationId: massgov.pfml.api.rmv_check.rmv_check_post
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/RMVCheckRequest"
      responses:
        "200":
          description: Summary of the check
          content:
            application/json:
              schema:
                allOf:
                  - $ref: "#/components/schemas/SuccessfulResponse"
                  - properties:
                      data:
                        $ref: "#/components/schemas/RMVCheckResponse"
                example:
                  meta:
                    method: "POST"
                    resource: "/rmv-check"
                  status_code: 200
                  message: "success"
                  data:
                    verified: true
                    description: Verification check passed.
        "400":
          $ref: "#/components/responses/BadRequest"
        default:
          $ref: "#/components/responses/UnexpectedError"

  /notifications:
    post:
      security:
        - oauth2: []
      tags:
        - Notifications
      summary: >
        Send a notification that a document is available for a claimant to either the claimant or leave administrator.
      operationId: massgov.pfml.api.notifications.notifications_post
      responses:
        "201":
          description: a successful response returns a 201 status code and asynchronously starts the notification process.
          content:
            application/json:
              schema:
                allOf:
                  - $ref: "#/components/schemas/SuccessfulResponse"
                example:
                  meta:
                    method: "POST"
                    resource: "/notifications"
                  status_code: 201
                  message: "success"
        "400":
          $ref: "#/components/responses/BadRequest"
        "503":
          description: todo
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
      requestBody:
        $ref: "#/components/requestBodies/NotificationRequest"

  /employers/verifications:
    post:
      tags:
        - Verifications
      summary: >
        Check to see if user should be verified and create verification record
      operationId: massgov.pfml.api.verifications.verifications
      responses:
        "201":
          description: Checks verification data, and if valid, creates a verification record for a leave admin
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/UserResponse"
        "400":
          $ref: "#/components/responses/BadRequest"
      requestBody:
        $ref: "#/components/requestBodies/VerificationRequest"

  /admin/authorize:
    get:
      security:
        - {} # no authentication required
      tags:
        - Admin
      summary: Returns azure ad authentication url to initiate user auth code flow
      operationId: massgov.pfml.api.admin.admin_authorization_url
      responses:
        "200":
          description: Initiated authentication code flow
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/AuthURIResponse"

  /admin/token:
    post:
      security:
        - {} # no authentication required
      tags:
        - Admin
      summary: Trade an authentication code for an access token
      operationId: massgov.pfml.api.admin.admin_token
      requestBody:
        $ref: "#/components/requestBodies/AdminTokenRequest"
      responses:
        "200":
          $ref: "#/components/responses/AdminTokenResponse"
        "401":
          $ref: "#/components/responses/BadRequest"
        "404":
          $ref: "#/components/responses/NotFound"

  /admin/login:
    get:
      security:
        - jwt: []
      tags:
        - Admin
      summary: Login as admin user
      operationId: massgov.pfml.api.admin.admin_login
      responses:
        "200":
          description: Successfully logged in as admin account!
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/AdminUserResponse"
        "400":
          $ref: "#/components/responses/Unauthorized"
        "401":
          $ref: "#/components/responses/BadRequest"
        "404":
          $ref: "#/components/responses/NotFound"

  /admin/logout:
    get:
      security:
        - {} # no authentication required
      tags:
        - Admin
      summary: Logout admin user
      operationId: massgov.pfml.api.admin.admin_logout
      responses:
        "200":
          description: Retrieved logout url
          content: 
            application/json:
              schema:
                $ref: "#/components/schemas/AdminLogoutResponse"

  /admin/users:
    get:
      tags:
        - Admin
        - Users
      summary: Retrieve all user accounts
      operationId: massgov.pfml.api.admin.admin_users_get
      parameters:
        - $ref: "#/components/parameters/pageSize"
        - $ref: "#/components/parameters/pageOffset"
        - name: email_address
          in: query
          schema:
            type: string
          description: A partial email address, will be used as a wildcard.
          required: false
      responses:
        "200":
          description: A successful request returns a 200 status code and user objects.
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/UserResponse"
        "401":
          $ref: "#/components/responses/BadRequest"
        "404":
          $ref: "#/components/responses/NotFound"

tags:
  - name: Test Endpoints
  - name: Roles
  - name: Users
  - name: Employees
  - name: Employers
  - name: Claims
  - name: Applications
  - name: Financial Eligibility
  - name: ID Proofing
  - name: Notifications
  - name: Feature Flags
  - name: Admin

components:
  securitySchemes:
    jwt:
      type: http
      scheme: bearer
      bearerFormat: JWT
      x-bearerInfoFunc: massgov.pfml.api.authentication.decode_jwt
    oauth2:
      type: oauth2
      x-tokenInfoFunc: massgov.pfml.api.authentication.decode_jwt
      flows:
        clientCredentials:
          tokenUrl: /api/v1/oauth2/token
          scopes: {}

  parameters:
    pageSize:
      name: "page_size"
      in: query
      required: false
      schema:
        type: integer
        format: int32
        minimum: 1
        default: 25
    pageOffset:
      name: "page_offset"
      in: query
      required: false
      schema:
        type: integer
        format: int32
        minimum: 1
        default: 1
    orderBy:
      name: "order_by"
      in: query
      required: false
      schema:
        type: string
        default: "created_at"
        enum: ["fineos_absence_status", "created_at", "employee"]
    orderDirection:
      name: "order_direction"
      in: query
      required: false
      schema:
        type: string
        default: "descending"
        enum: ["ascending", "descending"]

  requestBodies:
    AdminTokenRequest:
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/AdminTokenRequest"
      required: true
    RoleUserDeleteRequest:
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/RoleUserDeleteRequest"
      required: true
    UserUpdateRequest:
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/UserUpdateRequest"
      required: true
    EmployeeSearchRequest:
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/EmployeeSearchRequest"
      required: true
    EmployeeUpdateRequest:
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/EmployeeUpdateRequest"
      required: true
    EmployerClaimRequestBody:
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/EmployerClaimRequestBody"
      required: true
    ApplicationRequestBody:
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/ApplicationRequestBody"
      required: true
    ApplicationImportRequestBody:
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/ApplicationImportRequestBody"
    EligibilityRequest:
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/EligibilityRequest"
      required: true
    NotificationRequest:
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/NotificationRequest"
      required: true
    VerificationRequest:
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/VerificationRequest"
      required: true
    PaymentPreferenceRequestBody:
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/PaymentPreferenceRequestBody"
      required: true
    TaxWithholdingPreferenceRequestBody:
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/TaxWithholdingPreferenceRequestBody"
    EmployerAddFeinRequestBody:
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/EmployerAddFeinRequestBody"

  responses:
    AdminTokenResponse:
      description: User has successfully logged into microsoft account
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/AdminTokenResponse"
    ApplicationResponse:
      description: Application found
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/ApplicationResponse"
    ApplicationCreatedResponse:
      description: A new application successfully created
      content:
        application/json:
          schema:
            allOf:
              - $ref: "#/components/schemas/SuccessfulResponse"
              - properties:
                  data:
                    $ref: "#/components/schemas/ApplicationResponse"
    ApplicationImportedResponse:
      description: Application successfully imported
      content:
        application/json:
          schema:
            allOf:
              - $ref: "#/components/schemas/SuccessfulResponse"
              - properties:
                  data:
                    $ref: "#/components/schemas/ApplicationResponse"
    ApplicationSearchResponse:
      description: Search successful
      content:
        application/json:
          schema:
            allOf:
              - $ref: "#/components/schemas/SuccessfulResponse"
              - properties:
                  data:
                    $ref: "#/components/schemas/ApplicationSearchResults"
    NotFound:
      description: The specified resource was not found
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/ErrorResponse"
    Unauthorized:
      description: Unauthorized
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/ErrorResponse"
    BadRequest:
      description: There was a problem with your request
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/ErrorResponse"
    ValidationError:
      description: Error validating the object
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/ErrorResponse"
    ServiceUnavailableError:
      description: The service is not available
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/ErrorResponse"
    UnexpectedError:
      description: Unexpected error
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/ErrorResponse"

  schemas:
    AuthURIResponse:
      type: object
      properties:
        auth_uri:
          type: string
        claims_challenge:
          type: string
          nullable: true
        code_verifier:
          type: string
        nonce:
          type: string
        redirect_uri:
          type: string
        scope:
          type: array
          items:
            type: string
        state:
          type: string

    AdminLogoutResponse:
      type: object
      properties:
        logout_uri:
          type: string

    AuthCodeResponse:
      type: object
      properties:
        code:
          type: string
        session_state:
          type: string
        state:
          type: string

    AdminTokenRequest:
      type: object
      properties:
        auth_uri_res:
          $ref: "#/components/schemas/AuthURIResponse"
        auth_code_res:
          $ref: "#/components/schemas/AuthCodeResponse"

    AdminTokenResponse:
      type: object
      properties:
        access_token:
          type: string
        refresh_token:
          type: string
        id_token:
          type: string

    SuccessfulResponse:
      type: object
      properties:
        status_code:
          type: integer
        message:
          type: string
        meta:
          $ref: "#/components/schemas/Meta"
        data:
          oneOf:
            - type: array
            - type: object
        warnings:
          type: array
          items:
            $ref: "#/components/schemas/ValidationErrorDetail"
      required: ["status_code"]
      additionalProperties: false

    ErrorResponse:
      type: object
      properties:
        status_code:
          type: integer
        message:
          type: string
        meta:
          $ref: "#/components/schemas/Meta"
        data:
          oneOf:
            - type: array
            - type: object
        warnings:
          type: array
          items:
            $ref: "#/components/schemas/ValidationErrorDetail"
        errors:
          type: array
          items:
            $ref: "#/components/schemas/ValidationErrorDetail"
      required: ["status_code", "errors"]
      additionalProperties: false

    Meta:
      type: object
      properties:
        resource:
          type: string
        method:
          type: string
        query:
          type: object
        paging:
          type: object
          properties:
            page_offset:
              type: integer
            page_size:
              type: integer
            total_records:
              type: integer
            total_pages:
              type: integer
            order_by:
              type: string
            order_direction:
              type: string
      required: ["resource", "method"]
      additionalProperties: false

    ValidationErrorDetail:
      type: object
      properties:
        type:
          example: "required"
          type: string
        message:
          example: "leave_details.reason is required."
          description: "Somewhat user-friendly description of the error. May contain PII."
          type: string
        rule:
          description: >
            Usage varies depending on the source of the validation error. OpenAPI validation
            errors will set this to the expected value behavior (i.e the max length, or pattern).
          oneOf:
            - type: string
            - type: number
            - type: integer
            - type: boolean
            - type: array
            - type: object
          nullable: true
        field:
          description: "Field path, when the error is associated with a specific field."
          example: "leave_details.reason"
          nullable: true
          type: string
      additionalProperties: false

    Address:
      type: object
      properties:
        city:
          type: string
          nullable: true
          maxLength: 40 # FINEOS requirement
          example: "Springfield"
        line_1:
          type: string
          nullable: true
          maxLength: 40 # FINEOS requirement
          example: "742 Evergreen Terrace"
        line_2:
          type: string
          nullable: true
          maxLength: 40 # FINEOS requirement
          example: ""
        state:
          type: string
          nullable: true
          maxLength: 40 # FINEOS requirement
          example: "MA"
        zip:
          type: string
          nullable: true
          pattern: '^[0-9]{5}((?:-[0-9]{4})?|(?:-\*{4})?)$'
          example: "12345"

    FlagResponse:
      type: object
      properties:
        start:
          type: string
          nullable: true
          format: date-time
          example: "2020-06-26T01:02:03.967736+00:00"
        end:
          type: string
          nullable: true
          format: date-time
          example: "2020-06-26T01:02:03.967736+00:00"
        name:
          type: string
          example: "maintenance"
        options:
          type: object
          example:
            page_routes:
             - "/applications/*"
             - "/employers/*"
        enabled:
          type: boolean
          example: false

    FlagsResponse:
      type: array
      items:
        $ref: "#/components/schemas/FlagResponse"

    UserResponse:
      type: object
      properties:
        user_id:
          type: string
          example: "009fa369-291b-403f-a85a-15e938c26f2f"
        auth_id:
          type: string
          format: uuid
          example: "00000000-291b-403f-a85a-15e938c26f2f"
        email_address:
          type: string
          format: email
          example: "janedoe@example.com"
        application_names:
          type: array
          items:
            type: object
            additionalProperties: false
            properties:
              first_name:
                type: string
                example: "Jane"
                nullable: true
              middle_name:
                type: string
                example: "Emily"
                nullable: true
              last_name:
                type: string
                example: "Doe"
                nullable: true
        mfa_delivery_preference:
          type: string
          enum:
            - SMS
            - Opt Out
          nullable: true
          example: "SMS"
        mfa_phone_number:
          $ref: "#/components/schemas/MaskedPhone"
          nullable: true
        consented_to_data_sharing:
          type: boolean
          example: false
        roles:
          type: array
          items:
            $ref: "#/components/schemas/RoleResponse"
        user_leave_administrators:
          type: array
          items:
            $ref: "#/components/schemas/UserLeaveAdminResponse"

    AdminUserResponse:
      type: object
      properties:
        sub_id:
          type: string
          example: "QfbsFWS4NTwEUFQKUCmwipIyJiZOxxKBLGSQC0tNFAB"
        first_name:
          type: string
          example: "Jane"
        last_name:
          type: string
          example: "Doe"
        email_address:
          type: string
          format: email
          example: "janedoe@example.com"
        groups:
          type: array
          items:
            type: string
        permissions:
          type: array
          items:
            type: string

    RoleResponse:
      type: object
      additionalProperties: false
      properties:
        role_id:
          type: integer
        role_description:
          type: string

    UserLeaveAdminResponse:
      type: object
      additionalProperties: false
      properties:
        employer_id:
          type: string
          format: uuid
          example: "009fa369-291b-403f-a85a-15e938c26f2f"
        employer_fein:
          type: string
          example: "41-9904348"
        employer_dba:
          type: string
          example: "The Super Store"
          nullable: true
        has_fineos_registration:
          type: boolean
        verified:
          type: boolean

    UserCreateRequest:
      type: object
      properties:
        email_address:
          type: string
          nullable: true
          format: email
          example: foo@example.com
        password:
          type: string
          nullable: true
          example: N~4Hq3>amXJ$
        role:
          type: object
          properties:
            role_description:
              description: Type of user account to be created
              type: string
              enum:
                - Claimant
                - Employer
              example: Employer
        user_leave_administrator:
          type: object
          nullable: true
          properties:
            employer_fein:
              $ref: "#/components/schemas/Fein"
              nullable: true

    RoleUserDeleteRequest:
      type: object
      additionalProperties: false
      properties:
        role:
          type: object
          additionalProperties: false
          properties:
            role_description:
              type: string
          required: ["role_description"]
        user_id:
          type: string
          format: uuid
          example: "fabd09ed-0ea9-4091-843e-2e37d2c61482"
      required: ["role", "user_id"]

    UserUpdateRequest:
      type: object
      additionalProperties: false
      properties:
        consented_to_data_sharing:
          type: boolean
          nullable: false
          example: true
        mfa_delivery_preference:
          type: string
          enum:
            - SMS
            - Opt Out
          nullable: true
          example: "SMS"
        mfa_phone_number:
          $ref: "#/components/schemas/Phone"

    EmployeeUpdateRequest:
      type: object
      properties:
        first_name:
          type: string
          example: "Jane"
          nullable: false
          minLength: 1
        middle_name:
          type: string
          example: "Alice"
          nullable: false
          minLength: 1
        last_name:
          type: string
          example: "Doe"
          nullable: false
          minLength: 1
        email_address:
          type: string
          format: email
          example: "j.a.doe@gmail.com"
          nullable: false
          minLength: 1

    EmployeeSearchRequest:
      type: object
      properties:
        first_name:
          type: string
          example: "Jane"
        middle_name:
          type: string
          example: "Alice"
        last_name:
          type: string
          example: "Doe"
        tax_identifier_last4:
          type: string
          example: "1234"
      required: ["first_name", "last_name", "tax_identifier_last4"]

    EmployeeErrorResponse:
      type: object

    EmployeeResponse:
      type: object
      properties:
        employee_id:
          type: string
          format: uuid
          example: "009fa369-291b-403f-a85a-15e938c26a7b"
        first_name:
          type: string
          example: "Jane"
        middle_name:
          type: string
          nullable: true
          example: "Alice"
        other_name:
          type: string
          nullable: true
          example: "Marie"
        email_address:
          type: string
          format: email
          nullable: true
          example: "jdoe@gmail.com"
        last_name:
          type: string
          example: "Doe"
        phone_numbers:
          type: array
          items:
            nullable: true
            $ref: "#/components/schemas/Phone"
        tax_identifier_last4:
          type: string
          nullable: true
          example: "1234"
        tax_identifier:
          $ref: "#/components/schemas/SsnItin"
          nullable: true
        fineos_customer_number:
          type: string
          nullable: true
          example: "1111111"
        mass_id_number:
          nullable: true
          $ref: "#/components/schemas/MassId"
        date_of_birth:
          nullable: true
          $ref: "#/components/schemas/MaskedDate"
      required: ["employee_id"]

    EmployeeBasicResponse:
      type: object
      properties:
        employee_id:
          type: string
          format: uuid
          example: "009fa369-291b-403f-a85a-15e938c26a7b"
        first_name:
          type: string
          example: "Jane"
        middle_name:
          type: string
          nullable: true
          example: "Alice"
        last_name:
          type: string
          example: "Doe"
        other_name:
          type: string
          nullable: true
          example: "Marie"
      required: ["employee_id"]

    EmployerClaimRequestBody:
      type: object
      properties:
        uses_second_eform_version:
          type: boolean
        employer_benefits:
          type: array
          items:
            $ref: "#/components/schemas/EmployerBenefit"
          maxItems: 10
        concurrent_leave:
          $ref: "#/components/schemas/ConcurrentLeave"
          nullable: true
        previous_leaves:
          type: array
          items:
            $ref: "#/components/schemas/PreviousLeave"
          maxItems: 16
        has_amendments:
          type: boolean
        hours_worked_per_week:
          type: number
          nullable: true
          example: 40.5
        employer_decision:
          type: string
          enum:
            - Approve
            - Deny
            - Requires More Information
        fraud:
          type: string
          enum:
            - "Yes"
            - "No"
        comment:
          type: string
          maxLength: 9999
        leave_reason:
          type: string
          nullable: true
          example: Care for a Family Member
        believe_relationship_accurate:
          type: string
          nullable: true
          enum:
            - "Yes"
            - "No"
            - "Unknown"
        relationship_inaccurate_reason:
          type: string
          nullable: true
          maxLength: 9999
          example: Their reported info doesn't match my records
      additionalProperties: false
      required:
        - employer_benefits
        - previous_leaves
        - hours_worked_per_week

    UpdateClaimReviewResponse:
      type: object
      properties:
        claim_id:
          type: string
      additionalProperties: false
      required:
        - claim_id

    ClaimReviewResponse:
      type: object
      properties:
        concurrent_leave:
          $ref: "#/components/schemas/ConcurrentLeave"
          nullable: true
        date_of_birth:
          $ref: "#/components/schemas/MaskedDate"
        employer_benefits:
          type: array
          items:
            $ref: "#/components/schemas/EmployerBenefit"
        employer_dba:
          type: string
          nullable: true
        employer_id:
          type: string
          format: uuid
        employer_fein:
          $ref: "#/components/schemas/Fein"
        fineos_absence_id:
          type: string
          example: "NTN-111-ABS-01"
        first_name:
          type: string
        hours_worked_per_week:
          type: string
        last_name:
          type: string
        leave_details:
          $ref: "#/components/schemas/EmployerLeaveDetails"
        status:
          type: string
        middle_name:
          type: string
        uses_second_eform_version:
          type: boolean
        previous_leaves:
          type: array
          items:
            $ref: "#/components/schemas/PreviousLeave"
        residential_address:
          $ref: "#/components/schemas/Address"
        tax_identifier:
          $ref: "#/components/schemas/MaskedSsnItin"
        absence_periods:
          type: array
          items:
            $ref: "#/components/schemas/AbsencePeriodResponse"
        managed_requirements:
          type: array
          items:
            $ref: "#/components/schemas/ManagedRequirementResponse"
      additionalProperties: false
      required:
        - employer_benefits
        - employer_dba
        - employer_fein
        - employer_id
        - fineos_absence_id
        - leave_details
        - previous_leaves
        - residential_address
        - status
        - uses_second_eform_version
        - absence_periods

    ConcurrentLeave:
      type: object
      properties:
        concurrent_leave_id:
          type: string
          format: uuid
          example: "2a340cf8-6d2a-4f82-a075-73588d003f8f"
          nullable: true
        is_for_current_employer:
          type: boolean
          nullable: true
          example: true
        leave_end_date:
          $ref: "#/components/schemas/Date"
          nullable: true
        leave_start_date:
          $ref: "#/components/schemas/Date"
          nullable: true

    PreviousLeave:
      type: object
      properties:
        previous_leave_id:
          type: string
          format: uuid
          example: "2a340cf8-6d2a-4f82-a075-73588d003f8f"
          nullable: true
        is_for_current_employer:
          type: boolean
          nullable: true
          example: true
        leave_end_date:
          $ref: "#/components/schemas/Date"
          nullable: true
        leave_start_date:
          $ref: "#/components/schemas/Date"
          nullable: true
        leave_reason:
          type: string
          nullable: true
          enum:
            - Pregnancy
            - Caring for a family member with a serious health condition
            - Bonding with my child after birth or placement
            - Caring for a family member who serves in the armed forces
            - Managing family affairs while a family member is on active duty in the armed forces
            - Unknown
            - An illness or injury
        worked_per_week_minutes:
          type: integer
          nullable: true
          minimum: 0
        leave_minutes:
          type: integer
          nullable: true
          minimum: 0
        type:
          type: string
          nullable: true
          enum:
            - other_reason
            - same_reason

    ApplicationRequestBody:
      allOf:
        - type: object
          properties:
            organization_unit_selection:
              type: string
              nullable: true
              enum:
                - not_listed
                - not_selected
            organization_unit_id:
              type: string
              format: uuid
              example: "2f0f58a0-fcad-465b-b474-ee6c961cd6e3"
              nullable: true
            application_nickname:
              type: string
              nullable: true
              example: "My bonding leave request"
            tax_identifier:
              $ref: "#/components/schemas/SsnItin"
              nullable: true
            employer_fein:
              $ref: "#/components/schemas/Fein"
              nullable: true
            hours_worked_per_week:
              type: number
              nullable: true
              example: 40.5
            first_name:
              type: string
              nullable: true
              maxLength: 50
              example: "John"
            middle_name:
              type: string
              nullable: true
              maxLength: 50
              example: "Jake"
            last_name:
              type: string
              nullable: true
              maxLength: 50
              example: "Doe"
            date_of_birth:
              $ref: "#/components/schemas/DateOrMaskedDate"
              nullable: true
            has_mailing_address:
              type: boolean
              nullable: true
              example: false
            mailing_address:
              $ref: "#/components/schemas/Address"
              nullable: true
            residential_address:
              $ref: "#/components/schemas/Address"
              nullable: true
            has_continuous_leave_periods:
              type: boolean
              nullable: true
              example: true
            has_employer_benefits:
              type: boolean
              nullable: true
              example: true
            has_intermittent_leave_periods:
              type: boolean
              nullable: true
              example: true
            has_other_incomes:
              type: boolean
              nullable: true
              example: true
            has_reduced_schedule_leave_periods:
              type: boolean
              nullable: true
              example: true
            has_state_id:
              type: boolean
              nullable: true
              example: true
            mass_id:
              $ref: "#/components/schemas/MassId"
              nullable: true
            employment_status:
              type: string
              nullable: true
              enum:
                - Employed
                - Unemployed
                - Self-Employed
              example: "Employed"
            occupation:
              type: string
              nullable: true
              enum:
                - Sales Clerk
                - Administrative
                - Engineer
                - Health Care
              example: "Sales Clerk"
            gender:
              type: string
              nullable: true
              enum:
                - Woman
                - Man
                - Non-binary
                - Gender not listed
                - Prefer not to answer
            leave_details:
              $ref: "#/components/schemas/ApplicationLeaveDetails"
            work_pattern:
              $ref: "#/components/schemas/WorkPattern"
              nullable: true
            employer_benefits:
              nullable: true
              type: array
              items:
                $ref: "#/components/schemas/EmployerBenefit"
              maxItems: 6
            other_incomes:
              nullable: true
              type: array
              items:
                $ref: "#/components/schemas/OtherIncome"
              maxItems: 6
            phone:
              $ref: "#/components/schemas/Phone"
            has_previous_leaves_other_reason:
              type: boolean
              nullable: true
            has_previous_leaves_same_reason:
              type: boolean
              nullable: true
            has_concurrent_leave:
              type: boolean
              nullable: true
            previous_leaves_other_reason:
              nullable: true
              type: array
              items:
                $ref: "#/components/schemas/PreviousLeave"
              maxItems: 6
            previous_leaves_same_reason:
              nullable: true
              type: array
              items:
                $ref: "#/components/schemas/PreviousLeave"
              maxItems: 6
            concurrent_leave:
              $ref: "#/components/schemas/ConcurrentLeave"
              nullable: true
        - type: object
          properties:
            tax_identifier:
              nullable: true
            employer_fein:
              nullable: true
            date_of_birth:
              nullable: true
            mass_id:
              nullable: true

    ApplicationImportRequestBody:
      type: object
      properties:
        absence_case_id:
          type: string
          example: "NTN-111-ABS-01"
          nullable: true
        tax_identifier:
          $ref: "#/components/schemas/SsnItin"
          nullable: true

    ApplicationResponse:
      type: object
      properties:
        application_nickname:
          type: string
          example: "My bonding leave request"
          nullable: true
        organization_unit_id:
          type: string
          format: uuid
          example: "2f0f58a0-fcad-465b-b474-ee6c961cd6e3"
          nullable: true
        application_id:
          type: string
          format: uuid
          example: "2a340cf8-6d2a-4f82-a075-73588d003f8f"
        fineos_absence_id:
          type: string
          example: "NTN-111-ABS-01"
        tax_identifier:
          $ref: "#/components/schemas/MaskedSsnItin"
          nullable: true
        employer_id:
          type: string
          format: uuid
          example: "2f0f58a0-fcad-465b-b474-ee6c961cd6e3"
          nullable: true
        employer_fein:
          type: string
          nullable: true
          example: "41-9904348"
        first_name:
          type: string
          example: "John"
          nullable: true
        middle_name:
          type: string
          example: "Jake"
          nullable: true
        last_name:
          type: string
          example: "Doe"
          nullable: true
        date_of_birth:
          nullable: true
          $ref: "#/components/schemas/MaskedDate"
        has_continuous_leave_periods:
          type: boolean
          nullable: true
          example: true
        has_employer_benefits:
          type: boolean
          nullable: true
          example: true
        has_intermittent_leave_periods:
          type: boolean
          nullable: true
          example: true
        has_reduced_schedule_leave_periods:
          type: boolean
          nullable: true
          example: true
        has_other_incomes:
          type: boolean
          nullable: true
          example: true
        has_submitted_payment_preference:
          type: boolean
          nullable: true
          example: true
        has_state_id:
          type: boolean
          nullable: true
          example: true
        has_mailing_address:
          type: boolean
          nullable: true
          example: false
        mailing_address:
          $ref: "#/components/schemas/Address"
          nullable: true
        residential_address:
          $ref: "#/components/schemas/Address"
          nullable: true
        mass_id:
          type: string
          nullable: true
          example: "*********"
        employment_status:
          type: string
          enum:
            - Employed
            - Unemployed
            - Self-Employed
          example: "Employed"
          nullable: true
        occupation:
          type: string
          enum:
            - Sales Clerk
            - Administrative
            - Engineer
            - Health Care
          example: "Sales Clerk"
          nullable: true
        employee_organization_units:
          type: array
          items:
            $ref: "#/components/schemas/OrganizationUnit"
        employer_organization_units:
          type: array
          items:
            $ref: "#/components/schemas/OrganizationUnit"
        organization_unit:
          nullable: true
          allOf:
            - $ref: "#/components/schemas/OrganizationUnit"
        organization_unit_selection:
          type: string
          nullable: true
          enum:
            - not_listed
            - not_selected
        gender:
          type: string
          nullable: true
          enum:
            - Woman
            - Man
            - Non-binary
            - Gender not listed
            - Prefer not to answer
        hours_worked_per_week:
          type: number
          nullable: true
          example: 40.5
        leave_details:
          $ref: "#/components/schemas/ApplicationLeaveDetails"
          nullable: true
        payment_preference:
          type: object
          items:
            $ref: "#/components/schemas/PaymentPreference"
          nullable: true
        work_pattern:
          $ref: "#/components/schemas/WorkPattern"
          nullable: true
        employer_benefits:
          type: array
          items:
            $ref: "#/components/schemas/EmployerBenefit"
          nullable: true
        other_incomes:
          type: array
          items:
            $ref: "#/components/schemas/OtherIncome"
          nullable: true
        imported_from_fineos_at:
          type: string
          format: date-time
          nullable: true
          example: "2020-06-26T01:02:03.967736+00:00"
        updated_at:
          type: string
          format: date-time
          example: "2020-06-26T01:02:03.967736+00:00"
        updated_time:
          type: string
          format: date-time
          description: |
            This field is deprecated. Please use `updated_at`.
          example: "2020-06-26T01:02:03.967736+00:00"
        status:
          type: string
          description: |
            The current application status.

            * `Started` - is started and in progress.
            * `Submitted` - is successfully stored in the claims processing system.
            * `Completed` - is marked complete and has been submitted by the user.
          enum:
            - Started
            - Submitted
            - Completed
          example: "Started"
        phone:
          $ref: "#/components/schemas/MaskedPhone"
        has_previous_leaves_other_reason:
          type: boolean
          nullable: true
        has_previous_leaves_same_reason:
          type: boolean
          nullable: true
        has_concurrent_leave:
          type: boolean
          nullable: true
        previous_leaves_other_reason:
          type: array
          items:
            $ref: "#/components/schemas/PreviousLeave"
        previous_leaves_same_reason:
          type: array
          items:
            $ref: "#/components/schemas/PreviousLeave"
        concurrent_leave:
          $ref: "#/components/schemas/ConcurrentLeave"
          nullable: true
        is_withholding_tax:
          type: boolean
          nullable: true

    DocumentUploadRequest:
      type: object
      properties:
        document_type:
          type: string
          enum:
            - Passport
            - Driver's License Mass
            - Driver's License Other State
            - Identification Proof
            - State managed Paid Leave Confirmation
            - Approval Notice
            - Request for More information
            - Denial Notice
            - Own serious health condition form
            - Pregnancy/Maternity form
            - Child bonding evidence form
            - Care for a family member form
            - Military exigency form
            - Pending Application Withdrawn
            - Appeal Acknowledgment
            - Maximum Weekly Benefit Change Notice
            - Benefit Amount Change Notice
            - Leave Allotment Change Notice
            - Approved Time Cancelled
            - Change Request Approved
            - Change Request Denied
            - Certification Form # Only used when Claimant Portal uploads certification docs
          example: "Passport"
        name:
          type: string
          example: "passport.png"
        description:
          type: string
          example: "Jane Smith Passport"
        mark_evidence_received:
          type: boolean
          example: false
        file:
          type: string
          format: binary
          nullable: false
      required:
        - document_type
        - file
      additionalProperties: false

    WithholdingResponse:
      type: object
      properties:
        filing_period:
          format: date
          example: "1970-06-01"

    ManagedRequirementResponse:
      type: object
      properties:
        follow_up_date:
          format: date
          example: "1970-06-01"
        responded_at:
          format: date
          example: "1970-06-01"
        status:
          type: string
          nullable: true
        category:
          type: string
          nullable: true
        type:
          type: string
          nullable: true
        created_at:
          format: date
    AbsencePeriodResponse:
      type: object
      properties:
        absence_period_start_date:
          type: string
          format: date
          example: "2021-06-01"
        absence_period_end_date:
          type: string
          format: date
          example: "2021-06-08"
        reason:
          type: string
          enum:
            - Care for a Family Member
            - Pregnancy/Maternity
            - Child Bonding
            - Serious Health Condition - Employ
          example: "Child Bonding"
        reason_qualifier_one:
          type: string
          enum:
            - Newborn
            - Adoption
            - Foster Care
          example: "Newborn"
        reason_qualifier_two:
          type: string
        period_type:
          type: string
          enum:
            - Continuous
            - Intermittent
            - Reduced Schedule
          example: "Continuous"
        request_decision:
          type: string
          enum:
            - Pending
            - Approved
            - Denied
            - Withdrawn
          example: "Approved"
        fineos_leave_request_id:
          type: integer
          example: 1234


    DetailedClaimResponse:
      type: object
      properties:
        employer:
          $ref: "#/components/schemas/EmployerResponse"
        employee:
          $ref: "#/components/schemas/EmployeeBasicResponse"
        application_id:
          type: string
          format: uuid
          example: "fdc23456-c8fa-48bf-89a1-5c7c6a3af164"
        fineos_absence_id:
          format: string
          example: "NTN-01-ABS-01"
        fineos_notification_id:
          format: string
          example: "NTN-01"
        created_at:
          format: date
        absence_periods:
            type: array
            items:
              $ref: "#/components/schemas/AbsencePeriodResponse"
        outstanding_evidence:
          type: object
          properties:
            employee_evidence:
              type: array
              items:
                $ref: "#/components/schemas/EvidenceStatusDetail"
            employer_evidence:
              type: array
              items:
                $ref: "#/components/schemas/EvidenceStatusDetail"
        has_paid_payments:
          type: boolean
          example: false

    ClaimResponse:
      type: object
      properties:
        employer:
          $ref: "#/components/schemas/EmployerResponse"
        employee:
          $ref: "#/components/schemas/EmployeeBasicResponse"
        fineos_absence_id:
          format: string
          example: "NTN-01-ABS-01"
        fineos_notification_id:
          format: string
          example: "NTN-01"
        absence_period_start_date:
          format: date
          example: "1970-06-01"
        absence_period_end_date:
          format: date
          example: "1970-06-01"
        claim_status:
          description: "Absence case status"
          format: string
          example: "Approved"
        claim_type_description:
          format: string
          example: "Medical Leave"
        organization_unit_id:
          type: string
          format: uuid
          example: "2f0f58a0-fcad-465b-b474-ee6c961cd6e3"
        created_at:
          format: date
        managed_requirements:
            type: array
            items:
              $ref: "#/components/schemas/ManagedRequirementResponse"
        absence_periods:
            type: array
            items:
              $ref: "#/components/schemas/AbsencePeriodResponse"
        has_paid_payments:
          type: boolean
          example: false

    ClaimsResponse:
      type: array
      items:
        $ref: "#/components/schemas/ClaimResponse"

    PaymentsResponse:
      type: object
      properties:
        absence_case_id:
          format: string
          example: "NTN-01-ABS-01"
        payments:
          type: array
          items:
            $ref: "#/components/schemas/PaymentResponse"

    PaymentResponse:
      type: object
      properties:
        payment_id:
          type: string
          format: uuid
          nullable: true
        period_start_date:
          format: date
          example: "1970-06-01"
        period_end_date:
          format: date
          example: "1970-06-01"
        amount:
          type: number
          nullable: true
          example: 750.25
        sent_to_bank_date:
          format: date
          example: "1970-06-01"
          nullable: true
          type: string
        payment_method:
            type: string
            enum:
              - Elec Funds Transfer
              - Check
              - Debit
            nullable: true
            example: "Elec Funds Transfer"
        expected_send_date_start:
          format: date
          type: string
          nullable: true
          example: "1970-06-01"
        expected_send_date_end:
          format: date
          type: string
          nullable: true
          example: "1970-06-01"
        cancellation_date:
          format: date
          type: string
          nullable: true
          example: "2021-01-01"
        status:
          type: string
          enum:
            - Sent to bank
            - Pending
            - Cancelled
            - Delayed
          example: "Delayed"

    EvidenceStatusDetail:
      type: object
      properties:
        document_name:
          type: string
          example: "Document Name"
        is_document_received:
          type: boolean
          example: true

    EmployerResponse:
      type: object
      properties:
        employer_id:
          type: string
          format: uuid
          example: "fabd09ed-0ea9-4091-843e-2e37d2c61482"
        employer_fein:
          type: string
          example: "12-3456789"
        employer_dba:
          type: string
          nullable: true

    ClaimDocumentResponse:
      type: object
      properties:
        created_at:
          format: date
          type: string
          example: "1970-06-01"
          nullable: true
        document_type:
          type: string
          enum:
            - State managed Paid Leave Confirmation
            - Approval Notice
            - Request for More information
            - Denial Notice
            - Employer Response Additional Documentation
            - Own serious health condition form
            - Pregnancy/Maternity form
            - Child bonding evidence form
            - Care for a family member form
            - Military exigency form
            - Pending Application Withdrawn
            - Appeal Acknowledgment
            - Maximum Weekly Benefit Change Notice
            - Benefit Amount Change Notice
            - Leave Allotment Change Notice
            - Approved Time Cancelled
            - Change Request Approved
            - Change Request Denied
          example: "Denial Notice"
        content_type:
          type: string
          example: "image/png"
          nullable: true
        fineos_document_id:
          type: string
          example: "1234"
        name:
          type: string
          example: "passport.png"
          nullable: true
        description:
          type: string
          example: "Jane Smith Passport"
          nullable: true
      required:
        - created_at
        - document_type
        - content_type
        - fineos_document_id
        - name
        - description
      additionalProperties: false

    DocumentResponse:
      type: object
      properties:
        user_id:
          type: string
          format: uuid
          example: "fabd09ed-0ea9-4091-843e-2e37d2c61482"
        application_id:
          type: string
          format: uuid
          example: "fdc23456-c8fa-48bf-89a1-5c7c6a3af164"
        created_at:
          format: date
          example: "1970-06-01"
        document_type:
          type: string
          enum:
            - Passport
            - Driver's License Mass
            - Driver's License Other State
            - Identification Proof
            - State managed Paid Leave Confirmation
            - Own serious health condition form
            - Pregnancy/Maternity form
            - Child bonding evidence form
            - Care for a family member form
            - Military exigency form
            - Pending Application Withdrawn
            - Appeal Acknowledgment
            - Maximum Weekly Benefit Change Notice
            - Benefit Amount Change Notice
            - Leave Allotment Change Notice
            - Approved Time Cancelled
            - Change Request Approved
            - Change Request Denied
          example: "Passport"
        content_type:
          type: string
          example: "image/png"
        fineos_document_id:
          type: string
          example: "1234"
        name:
          type: string
          example: "passport.png"
        description:
          type: string
          example: "Jane Smith Passport"
      required:
        - user_id
        - application_id
        - created_at
        - document_type
        - content_type
        - fineos_document_id
        - name
        - description
      additionalProperties: false

    PaymentPreferenceRequestBody:
      type: object
      properties:
        payment_preference:
          nullable: false
          $ref: "#/components/schemas/PaymentPreference"

    TaxWithholdingPreferenceRequestBody:
      type: object
      properties:
        is_withholding_tax:
          type: boolean
          nullable: true

    EmployerAddFeinRequestBody:
      type: object
      properties:
        employer_fein:
          $ref: "#/components/schemas/Fein"
          nullable: true

    EligibilityRequest:
      type: object
      properties:
        tax_identifier:
          nullable: false
          required: true
          $ref: "#/components/schemas/SsnItin"
        employer_fein:
          nullable: false
          $ref: "#/components/schemas/Fein"
        leave_start_date:
          nullable: false
          $ref: "#/components/schemas/Date"
        application_submitted_date:
          nullable: false
          $ref: "#/components/schemas/Date"
        employment_status:
          type: string
          enum:
            - Employed
            - Unemployed
            - Self-Employed
            - Unknown
            - Retired
          example: "Employed"
          nullable: false
      required:
        - tax_identifier
        - employer_fein
        - leave_start_date
        - application_submitted_date
        - employment_status

    EligibilityResponse:
      type: object
      properties:
        financially_eligible:
          type: boolean
          example: false
        description:
          type: string
          example: "Claimant wages under minimum"
        total_wages:
          type: number
          example: 75000
          nullable: true
        state_average_weekly_wage:
          type: integer
          example: 1431
          nullable: true
        unemployment_minimum:
          type: integer
          example: 5100
          nullable: true
        employer_average_weekly_wage:
          type: number
          example: 1500
          nullable: true
      required:
        - financially_eligible
        - description

    EmployerLeaveDetails:
      type: object
      properties:
        reason:
          type: string
          nullable: true
        continuous_leave_periods:
          $ref: "#/components/schemas/EmployerContinuousLeavePeriods"
        intermittent_leave_periods:
          $ref: "#/components/schemas/EmployerIntermittentLeavePeriods"
        reduced_schedule_leave_periods:
          $ref: "#/components/schemas/EmployerReducedScheduleLeavePeriods"

    EmployerContinuousLeavePeriods:
      type: object
      properties:
        start_date:
          $ref: "#/components/schemas/Date"
        end_date:
          $ref: "#/components/schemas/Date"

    EmployerIntermittentLeavePeriods:
      type: object
      properties:
        start_date:
          $ref: "#/components/schemas/Date"
        end_date:
          $ref: "#/components/schemas/Date"
        frequency:
          type: integer
          nullable: true
          example: 4
        frequency_interval:
          type: integer
          nullable: true
          example: 2
        frequency_interval_basis:
          type: string
          nullable: true
          enum:
            - Days
            - Weeks
            - Months
          example: "Weeks"
        duration:
          type: integer
          nullable: true
          example: 2
        duration_basis:
          type: string
          nullable: true
          enum:
            - Minutes
            - Hours
            - Days
          example: "Days"

    EmployerReducedScheduleLeavePeriods:
      type: object
      properties:
        start_date:
          $ref: "#/components/schemas/Date"
        end_date:
          $ref: "#/components/schemas/Date"


    ApplicationLeaveDetails:
      type: object
      description:
        Remove existing leave periods by including the key of the relevant type of leave period
        and an empty array or null value.
      properties:
        reason:
          type: string
          nullable: true
          enum:
            - Pregnancy/Maternity
            - Child Bonding
            - Serious Health Condition - Employee
            - Care for a Family Member
          example: "Child Bonding"
        reason_qualifier:
          type: string
          nullable: true
          enum:
            - Newborn
            - Adoption
            - Foster Care
          example: "Newborn"
        reduced_schedule_leave_periods:
          type: array
          nullable: true
          items:
            $ref: "#/components/schemas/ReducedScheduleLeavePeriods"
        continuous_leave_periods:
          type: array
          nullable: true
          items:
            $ref: "#/components/schemas/ContinuousLeavePeriods"
        intermittent_leave_periods:
          type: array
          nullable: true
          items:
            $ref: "#/components/schemas/IntermittentLeavePeriods"
        caring_leave_metadata:
          $ref: "#/components/schemas/CaringLeaveMetadata"
        pregnant_or_recent_birth:
          type: boolean
          nullable: true
          example: true
        child_birth_date:
          nullable: true
          $ref: "#/components/schemas/DateOrMaskedDate"
        child_placement_date:
          nullable: true
          $ref: "#/components/schemas/DateOrMaskedDate"
        has_future_child_date:
          type: boolean
          nullable: true
          example: true
        employer_notified:
          type: boolean
          nullable: true
          example: true
        employer_notification_date:
          nullable: true
          $ref: "#/components/schemas/Date"
        employer_notification_method:
          type: string
          nullable: true
          enum:
            - In Writing
            - In Person
            - By Telephone
            - Other
          example: "In Writing"

    ReducedScheduleLeavePeriods:
      type: object
      properties:
        leave_period_id:
          type: string
          format: uuid
          nullable: true
        start_date:
          nullable: true
          $ref: "#/components/schemas/Date"
        end_date:
          nullable: true
          $ref: "#/components/schemas/Date"
        thursday_off_minutes:
          type: integer
          minimum: 0
          nullable: true
          example: 90
        friday_off_minutes:
          type: integer
          minimum: 0
          nullable: true
          example: 90
        saturday_off_minutes:
          type: integer
          minimum: 0
          nullable: true
          example: 90
        sunday_off_minutes:
          type: integer
          minimum: 0
          nullable: true
          example: 90
        monday_off_minutes:
          type: integer
          minimum: 0
          nullable: true
          example: 90
        tuesday_off_minutes:
          type: integer
          minimum: 0
          nullable: true
          example: 90
        wednesday_off_minutes:
          type: integer
          minimum: 0
          nullable: true
          example: 90

    ContinuousLeavePeriods:
      type: object
      properties:
        leave_period_id:
          type: string
          format: uuid
          nullable: true
        start_date:
          nullable: true
          $ref: "#/components/schemas/Date"
        end_date:
          nullable: true
          $ref: "#/components/schemas/Date"
        last_day_worked:
          nullable: true
          $ref: "#/components/schemas/Date"
        expected_return_to_work_date:
          nullable: true
          $ref: "#/components/schemas/Date"
        start_date_full_day:
          type: boolean
          nullable: true
          example: true
        start_date_off_hours:
          type: integer
          nullable: true
          example: 0
        start_date_off_minutes:
          type: integer
          nullable: true
          example: 0
        end_date_off_hours:
          type: integer
          nullable: true
          example: 0
        end_date_off_minutes:
          type: integer
          nullable: true
          example: 0
        end_date_full_day:
          type: boolean
          nullable: true
          example: true

    IntermittentLeavePeriods:
      type: object
      properties:
        leave_period_id:
          type: string
          format: uuid
          nullable: true
        start_date:
          nullable: true
          $ref: "#/components/schemas/Date"
        end_date:
          nullable: true
          $ref: "#/components/schemas/Date"
        frequency:
          type: integer
          nullable: true
          example: 4
        frequency_interval:
          type: integer
          nullable: true
          example: 2
        frequency_interval_basis:
          type: string
          nullable: true
          enum:
            - Days
            - Weeks
            - Months
          example: "Weeks"
        duration:
          type: integer
          nullable: true
          example: 2
        duration_basis:
          type: string
          nullable: true
          enum:
            - Minutes
            - Hours
            - Days
          example: "Days"

    PaymentPreference:
      type: object
      properties:
        payment_method:
          type: string
          nullable: true
          enum:
            - Elec Funds Transfer
            - Check
            - Debit
          example: "Elec Funds Transfer"
        account_number:
          type: string
          nullable: true
          minLength: 6
          maxLength: 17
          example: "1234567"
        routing_number:
          nullable: true
          $ref: "#/components/schemas/RoutingNbr"
        bank_account_type:
          type: string
          nullable: true
          enum:
            - Checking
            - Savings
          example: "Checking"

    WorkPattern:
      type: object
      properties:
        work_pattern_type:
          type: string
          enum:
            - Fixed
            - Rotating
            - Variable
          nullable: true
        work_week_starts:
          $ref: "#/components/schemas/DayOfWeek"
          nullable: true
        pattern_start_date:
          $ref: "#/components/schemas/Date"
          nullable: true
        work_pattern_days:
          type: array
          maxItems: 7
          items:
            $ref: "#/components/schemas/WorkPatternDay"
          nullable: true

    WorkPatternDay:
      type: object
      properties:
        day_of_week:
          $ref: "#/components/schemas/DayOfWeek"
        week_number:
          type: integer
          minimum: 1
          maximum: 4
        minutes:
          type: integer
          minimum: 0
          nullable: true

    EmployerBenefit:
      type: object
      properties:
        employer_benefit_id:
          type: string
          format: uuid
          nullable: true
        benefit_start_date:
          $ref: "#/components/schemas/Date"
          nullable: true
        benefit_end_date:
          $ref: "#/components/schemas/Date"
          nullable: true
        benefit_amount_dollars:
          type: number
          nullable: true
          example: 400
        benefit_amount_frequency:
          type: string
          nullable: true
          enum:
            - Per Day
            - Per Week
            - Per Month
            - In Total
            - Unknown
          example: "Per Month"
        benefit_type:
          type: string
          nullable: true
          enum:
            - Accrued paid leave
            - Short-term disability insurance
            - Permanent disability insurance
            - Family or medical leave insurance
            - Unknown
        is_full_salary_continuous:
          type: boolean
          nullable: true


    OtherIncome:
      type: object
      properties:
        other_income_id:
          type: string
          format: uuid
          nullable: true
        income_start_date:
          $ref: "#/components/schemas/Date"
          nullable: true
        income_end_date:
          $ref: "#/components/schemas/Date"
          nullable: true
        income_amount_dollars:
          type: number
          nullable: true
          example: 700
        income_amount_frequency:
          type: string
          nullable: true
          enum:
            - Per Day
            - Per Week
            - Per Month
            - In Total
          example: "Per Month"
        income_type:
          type: string
          nullable: true
          enum:
            - Workers Compensation
            - Unemployment Insurance
            - SSDI
            - Disability benefits under Gov't retirement plan
            - Jones Act benefits
            - Railroad Retirement benefits
            - Earnings from another employment/self-employment
          example: "SSDI"

    ApplicationSearchResults:
      type: array
      items:
        $ref: "#/components/schemas/ApplicationResponse"

    RMVCheckRequest:
      allOf:
        - type: object
          additionalProperties: false
          properties:
            absence_case_id:
              title: Absence Case ID
              description:
                FINEOS ID for the case the check is being performed for.
              type: string
            date_of_birth:
              $ref: "#/components/schemas/Date"
            first_name:
              title: First Name
              description:
                This must match _exactly_ with what is on record with the RMV to
                be verified. This might be relevant because the RMV uses a
                restricted character set of `[a-zA-Z \-']` for names.
              type: string
              example: Jane
            last_name:
              title: Last Name
              description:
                This must match _exactly_ with what is on record with the RMV to
                be verified. This might be relevant because the RMV uses a
                restricted character set of `[a-zA-Z \-']` for names.
              type: string
              example: Doe
            mass_id_number:
              $ref: "#/components/schemas/MassId"
            residential_address_city:
              title: Residential Address - City
              type: string
              example: Boston
            residential_address_line_1:
              title: Residential Address - Line 1
              type: string
              example: 123 Main St.
            residential_address_line_2:
              title: Residential Address - Line 2
              type: string
              nullable: true
              example: Apt. 123
            residential_address_zip_code:
              title: Residential Address - Zip Code
              description:
                Accepts ZIP and ZIP+4 formats. Only first five characters are
                relevant for check.
              type: string
              pattern: ^\d{5}(-\d{4})?$
              example: "12345"
            ssn_last_4:
              title: SSN Last 4
              description:
                Last four characters of a Social Security Number.
              type: string
              pattern: ^\d{4}$
              example: "9999"
          required:
            - first_name
            - last_name
            - date_of_birth
            - ssn_last_4
            - mass_id_number
            - residential_address_line_1
            - residential_address_city
            - residential_address_zip_code
            - absence_case_id
        - type: object
          properties:
            mass_id_number:
              title: Massachusetts-issued ID number
              description: The ID number of a Mass ID or Massachusetts driver's license.

    RMVCheckResponse:
      type: object
      properties:
        verified:
          title: Verified
          description: Indicates if all data points were successfully verified.
          type: boolean
        description:
          title: Description
          description: Human-readable description of the verification result.
          type: string
      required:
        - verified
        - description

    NotificationRecipient:
      type: object
      properties:
        first_name:
          type: string
          example: "Jane"
          description: "Required if and only if recipient_type is Claimant"
        last_name:
          type: string
          example: "Doe"
          description: "Required if and only if recipient_type is Claimant"
        full_name:
          type: string
          example: "Jane Doe"
          description: "Required if and only if recipient_type is Leave Administrator"
        contact_id:
          type: string
          example: "11"
          description: "The contact ID of the recipient, only required if recipient type is a Leave Adminstrator"
        email_address:
          type: string
          format: email
          example: "j.a.doe@gmail.com"
          nullable: false
          minLength: 1


    NotificationClaimant:
      type: object
      properties:
        first_name:
          type: string
          example: "John"
          nullable: false
          minLength: 1
        last_name:
          type: string
          example: "Smith"
          nullable: false
          minLength: 1
        date_of_birth:
          $ref: "#/components/schemas/Date"
          nullable: false
        customer_id:
          type: string
          example: "1234"
          nullable: false

    NotificationRequest:
      type: object
      properties:
        absence_case_id:
          title: Absence Case ID
          description: FINEOS ID for the case the notification is related to.
          type: string
          example: NTN-111-ABS-01
          minLength: 1
        fein:
          type: string
          example: "41-9904348"
        organization_name:
          type: string
          example: "Wayne Enterprises"
        document_type:
          title: Document Type
          description: The type of document that is available to view.
          type: string
          example: Legal Notice
        trigger:
          title: Trigger
          description: The claim state that triggered the notification.
          type: string
          example: claim.approved
        source:
          title: Source
          description: The source of the claim application. Can be either Self-Service or Call Center.
          type: string
          example: Self-Service
          enum:
            - Self-Service
            - Call Center
        recipient_type:
          title: Recipient Type
          description: Who is receiving the notification/what type of person is in the recipients list. Can be either Claimant or Leave Administrator.
          type: string
          example: Leave Administrator
          enum:
            - Claimant
            - Leave Administrator
        recipients:
          type: array
          description: Who to send the notification to.
          items:
            $ref: "#/components/schemas/NotificationRecipient"
        claimant_info:
          $ref: "#/components/schemas/NotificationClaimant"

      required:
        - absence_case_id
        - trigger
        - source
        - recipient_type
        - recipients
        - claimant_info
        - fein
        - organization_name

    VerificationRequest:
      type: object
      properties:
        employer_id:
          type: string
          format: uuid
          example: 5f91c12b-4d49-4eb0-b5d9-7fa0ce13eb32
        withholding_amount:
          type: number
          example: 100
        withholding_quarter:
          type: string
          format: date
          example: "1970-06-01"
      required:
        - employer_id
        - withholding_amount
        - withholding_quarter

    OrganizationUnit:
      type: object
      properties:
        organization_unit_id:
          type: string
          format: uuid
          example: "2f0f58a0-fcad-465b-b474-ee6c961cd6e3"
        name:
          type: string
          example: "Sales"
      required:
        - organization_unit_id
        - name

    SsnItin:
      type: string
      example: "000-00-0000"
      pattern: '^[\d|\*]{3}-[\d|\*]{2}-\d{4}$'

    MaskedSsnItin:
      type: string
      example: "***-**-1234"
      pattern: '^\*{3}-\*{2}-\d{4}$'

    Fein:
      type: string
      example: "00-0000000"
      pattern: '^\d{2}-\d{7}$'

    MassId:
      type: string
      example: "S99988801"
      pattern: '^(\d{9}|S(\d{8}|A\d{7})|(\*{9}))$'

    RoutingNbr:
      type: string
      example: "031111111"
      pattern: '^((0[0-9])|(1[0-2])|(2[1-9])|(3[0-2])|(6[1-9])|(7[0-2])|80)([0-9]{7})$|(\*{9})$'

    Date:
      type: string
      example: '1970-01-01'
      format: date

    MaskedDate:
      type: string
      example: '****-01-01'
      pattern: '\*\*\*\*-[0-9]{2}-[0-9]{2}'

    DateOrMaskedDate:
      type: string
      example: '1970-01-01'
      format: maskable_date

    DayOfWeek:
      type: string
      enum:
        - Sunday
        - Monday
        - Tuesday
        - Wednesday
        - Thursday
        - Friday
        - Saturday

    Phone:
      type: object
      properties:
        int_code:
          type: string
          example: "1"
          pattern: "^[0-9]{1,3}"
          nullable: true
        phone_number:
          type: string
          example: "224-705-2345"
          pattern: '^([0-9]|\*){3}\-([0-9]|\*){3}\-[0-9]{4}$'
          nullable: true
        phone_type:
          type: string
          nullable: true
          enum:
            - Cell
            - Fax
            - Phone

    MaskedPhone:
      type: object
      properties:
        int_code:
          type: string
          example: "1"
          pattern: "^[0-9]{1,3}"
        phone_number:
          type: string
          example: "***-***-1234"
          pattern: '^\*{3}\-\*{3}\-[0-9]{4}$'
        phone_type:
          type: string
          enum:
            - Cell
            - Fax
            - Phone

    CaringLeaveMetadata:
      type: object
      properties:
        family_member_first_name:
          type: string
          example: "Jane"
          nullable: true
        family_member_middle_name:
          type: string
          example: "Alice"
          nullable: true
        family_member_last_name:
          type: string
          example: "Doe"
          nullable: true
        family_member_date_of_birth:
          $ref: "#/components/schemas/DateOrMaskedDate"
          nullable: true
        relationship_to_caregiver:
          type: string
          nullable: true
          enum:
            - Parent
            - Child
            - Grandparent
            - Grandchild
            - Other Family Member
            - Service Member
            - Inlaw
            - Sibling - Brother/Sister
            - Other
            - Spouse
